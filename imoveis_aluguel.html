<!DOCTYPE html>
<html class="light" lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Aluguel de Temporada em Palhoça, SC | Curtindo SC</title>
<meta name="description" content="Reserve as melhores casas e chalés para temporada na Guarda do Embaú e Pinheira.">
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,0" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script> 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#1BAEBD", 
            "background-light": "#f6f7f8", 
            "background-dark": "#101922", 
            "secondary": "#003366", 
            "accent": "#FF7F50", 
            "sand": { DEFAULT: "#f5f3f0", dark: "#e8e0d5" }
          },
          fontFamily: {
            "display": ["Work Sans"],
            "body": ["Lato", "sans-serif"]
          },
          borderRadius: {"DEFAULT": "0.5rem", "lg": "0.75rem", "xl": "1rem", "full": "9999px"},
        },
      },
    }
</script>
<style>
    .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
    .logo-img { height: 40px; width: auto; border-radius: 9999px; object-fit: cover; }
    .modal { display: none; position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.75); z-index: 50; align-items: center; justify-content: center; padding: 1rem; }
    .modal.show { display: flex; }
    .modal-content { max-height: 95vh; overflow-y: auto; }
    .flatpickr-calendar { z-index: 9999; }
    
    /* ESTILOS DA GALERIA */
    .gallery-thumbnail { 
        height: 80px; width: 80px; object-fit: cover; cursor: pointer; 
        border: 2px solid transparent; transition: all 0.2s; flex-shrink: 0; 
    }
    .gallery-thumbnail:hover { opacity: 0.8; }
    .gallery-thumbnail.active { border-color: #1BAEBD; opacity: 1; transform: scale(1.05); }
    
    .main-media-container { 
        position: relative; width: 100%; height: 400px; background-color: #000;
        display: flex; align-items: center; justify-content: center; overflow: hidden;
    }
    .main-media-container img, .main-media-container iframe { 
        width: 100%; height: 100%; object-fit: contain; 
    }

    /* ESTILO PARA ESTRELAS PREECHIDAS */
    .material-symbols-outlined.fill-current { font-variation-settings: 'FILL' 1; }
</style>
</head>
<body class="font-body bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">

<header class="sticky top-0 z-50 w-full bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex items-center justify-between whitespace-nowrap h-16">
<div class="flex items-center gap-4 text-gray-800 dark:text-gray-100">
    <img src="https://media.bio.site/sites/15fc0509-6c95-4782-9a79-fe69fe78ce69/ynmDRuF5gGpEBfxkyNUumk.png" alt="Logo Curtindo SC" class="logo-img">
    <h2 class="text-xl font-bold leading-tight tracking-[-0.015em] text-gray-900 dark:text-white">Curtindo SC</h2>
</div>
<div class="hidden md:flex flex-1 justify-end gap-8">
<div class="flex items-center gap-9">
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium leading-normal transition-colors" href="index.html">Início</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium leading-normal transition-colors" href="imoveis_venda.html">Comprar</a>
    <a class="text-primary dark:text-primary font-bold text-sm leading-normal transition-colors" href="imoveis_aluguel.html">Alugar</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium leading-normal transition-colors" href="sobre_nos.html">Sobre Nós</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium leading-normal transition-colors" href="contato.html">Contato</a>
</div>
<a class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors" href="https://wa.me/5548999998888" target="_blank">
<span class="truncate">Fale Conosco</span>
</a>
</div>
<button class="md:hidden text-gray-800 dark:text-gray-100">
<span class="material-symbols-outlined text-2xl">menu</span>
</button>
</div>
</div>
</header>

<main class="w-full">
<section class="relative h-[50vh] min-h-[400px] w-full">
<div class="absolute inset-0 bg-secondary/60 z-10"></div>
<img alt="Férias em Palhoça" class="h-full w-full object-cover" src="https://images.unsplash.com/photo-1499793983690-e29da59ef1c2?q=80&w=2070&auto=format&fit=crop"/>
<div class="absolute inset-0 z-20 flex flex-col items-center justify-center text-center text-white p-4">
<h1 class="text-4xl md:text-6xl font-display font-bold tracking-tight leading-tight drop-shadow-lg">Temporada dos Sonhos</h1>
<p class="mt-4 max-w-2xl text-lg md:text-xl text-gray-200 drop-shadow-md">Viva a experiência única de se hospedar na natureza preservada.</p>
</div>
</section>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
<div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
<p class="text-xl font-bold text-gray-900 dark:text-white">Opções de Temporada (Aluguel)</p>
<div class="relative w-full sm:w-48">
<select class="w-full appearance-none bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 py-2 pl-3 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white dark:focus:bg-gray-800 focus:border-primary dark:focus:border-primary-dark focus:ring-1 focus:ring-primary/50 dark:focus:ring-primary-dark/50 text-sm">
<option>Mais Relevantes</option>
<option>Menor Preço</option>
<option>Maior Preço</option>
<option>Datas Próximas</option>
</select>
<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300">
<span class="material-symbols-outlined text-lg"> expand_more </span>
</div>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="properties-grid">
</div>
<div class="flex justify-center mt-12">
<button class="py-3 px-6 bg-primary/10 dark:bg-secondary/20 text-primary dark:text-secondary font-bold rounded-lg hover:bg-primary/20 dark:hover:bg-secondary/30 transition-colors">Carregar mais imóveis</button>
</div>
</div>
</main>

<div id="details-modal" class="modal">
    <div class="modal-content bg-white dark:bg-background-dark rounded-xl shadow-2xl w-full max-w-5xl flex flex-col lg:flex-row relative">
        <button id="close-modal-button" class="absolute top-4 right-4 z-40 p-2 rounded-full bg-white/50 dark:bg-gray-900/50 text-gray-800 dark:text-white text-xl hover:bg-white dark:hover:bg-gray-700 transition-colors">
            <span class="material-symbols-outlined">close</span>
        </button>
        
        <div class="w-full lg:w-2/3 flex flex-col gap-4 p-4 dark:bg-gray-900">
            <div class="main-media-container rounded-lg shadow-lg bg-black">
                <img id="modal-main-image" src="" alt="Imagem principal do imóvel" class="hidden">
                <iframe id="modal-main-video" src="" frameborder="0" allow="autoplay; encrypted-media; gyroscope;" allowfullscreen class="hidden"></iframe>
            </div>
            <div class="w-full overflow-x-auto">
                <div id="modal-thumbnails" class="flex gap-3 pb-2 px-1 min-w-min"></div>
            </div>
        </div>

        <div class="w-full lg:w-1/3 p-6 space-y-4 overflow-y-auto max-h-[80vh]">
            <h2 id="modal-title" class="font-display text-2xl font-bold text-secondary dark:text-white"></h2>
            <p id="modal-location" class="text-gray-600 dark:text-gray-400 text-sm flex items-center gap-1"><span class="material-symbols-outlined text-lg">location_on</span></p>

            <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-gray-700 dark:text-gray-300 border-b pb-4">
                <span id="modal-rooms" class="flex items-center gap-1.5"><span class="material-symbols-outlined text-primary">bed</span></span>
                <span id="modal-baths" class="flex items-center gap-1.5"><span class="material-symbols-outlined text-primary">bathtub</span></span>
                <span id="modal-area" class="flex items-center gap-1.5"><span class="material-symbols-outlined text-primary">straighten</span></span>
            </div>

            <div id="modal-price-container">
                <p id="modal-price-label" class="text-lg font-bold text-gray-600 dark:text-gray-300"></p>
                <p id="modal-price" class="text-4xl font-black text-primary dark:text-white mt-1"></p>
                <div id="dates-info" class="text-sm text-red-500 font-medium mt-2"></div>
            </div>
            
            <div id="modal-features-list" class="pt-4 border-t border-gray-200 dark:border-gray-700">
                <h3 class="font-display text-lg font-bold text-secondary dark:text-white mb-2">Características</h3>
                <div id="features-container" class="grid grid-cols-2 gap-2 text-sm text-gray-700 dark:text-gray-300"></div>
            </div>

            <div id="reviews-container" class="pt-6 border-t border-gray-200 dark:border-gray-700 hidden">
                <div class="flex items-center gap-2 mb-4">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg" class="w-5 h-5" alt="Google">
                    <h3 class="font-display text-lg font-bold text-secondary dark:text-white">O que dizem os hóspedes</h3>
                    <span class="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full font-bold">4.9 ★</span>
                </div>
                <div id="reviews-list" class="space-y-4 max-h-60 overflow-y-auto pr-2"></div>
            </div>
            
            <form id="modal-rent-form" class="space-y-4 pt-4 border-t border-gray-200 dark:border-gray-700 hidden">
                <h4 class="font-display text-xl font-bold text-primary">Solicitar Reserva</h4>
                
                <input type="text" id="rent-guest-name" placeholder="Seu nome" required class="w-full form-input rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
                <input type="tel" id="rent-guest-contact" placeholder="Seu WhatsApp" required class="w-full form-input rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">

                <div>
                    <label for="rent-date-range" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Entrada / Saída</label>
                    <input type="text" id="rent-date-range" placeholder="Selecione as datas" required class="w-full form-input rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label for="guests-adults" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Adultos</label>
                        <input type="number" id="guests-adults" value="2" min="1" required class="w-full form-input rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label for="guests-children" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Crianças (0-12)</label>
                        <input type="number" id="guests-children" value="0" min="0" class="w-full form-input rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
                    </div>
                </div>

                <div id="reservation-summary" class="bg-blue-100 dark:bg-secondary/30 p-3 rounded-lg hidden">
                    <p class="text-secondary dark:text-white font-semibold">Resumo do Orçamento:</p>
                    <p id="summary-nights" class="text-sm text-gray-700 dark:text-gray-300"></p>
                    <p id="summary-guests" class="text-sm text-gray-700 dark:text-gray-300"></p>
                    <p id="summary-total" class="text-lg font-bold text-blue-800 dark:text-blue-200">Total: <span id="summary-total-value">R$ 0,00</span></p>
                    <p class="text-xs text-secondary dark:text-gray-300">(Diária: <span id="summary-daily-rate">R$ 0,00</span> x <span id="summary-nights-count">0</span> noites)</p>
                </div>

                <button type="submit" id="reserve-button" class="w-full flex items-center justify-center h-12 px-4 bg-primary text-white text-lg font-bold rounded-lg hover:bg-primary/90 transition-colors">
                    <span>Verificar Preço e Reservar</span>
                </button>
            </form>

            <form id="modal-sale-form" class="hidden">
                 <p class="text-red-500">Este imóvel é de aluguel.</p>
            </form>
            
        </div>
    </div>
</div>

<div id="alert-modal" class="modal">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
        <h2 id="alert-title" class="text-2xl font-bold mb-4 text-gray-900 dark:text-white">Aviso</h2>
        <p id="alert-message" class="mb-6 text-gray-600 dark:text-gray-300"></p>
        <button id="alert-ok-button" class="px-6 py-2 bg-gray-900 dark:bg-gray-100 dark:text-gray-900 text-white rounded-lg font-semibold">OK</button>
    </div>
</div>

<script>
    const propertyData = [
        {
            id: 'venda_luxo',
            title: 'Casa de Luxo c/ Piscina', location: 'Praia do Sonho, Palhoça',
            mode: 'sale', price_sale: 2500000, price_daily: 1800, rooms: 4, baths: 5, area: 220,
            description: "Descrição...", images: ["https://lh3.googleusercontent.com/aida-public/AB6AXuAQWr66uTJiCxpEEC2kU9O7mC8AFMT39XsOr4c6O5AhVzf6bDTAa5RYR76ksJQ6dRKt6dTVa2nE9HjrecWUDea-PxInZ8eTjGrNoEr84PEyTTIaoLqAnYf-wu8WLlmEUMP9UwlEb1ZiIULHSZavPV2lZQMd4MRtDFCzHZReFEZYVT5fH5UHxMDLxp_4R2XcAnsQGz-VG2G1wqi8oNoUTllBninRP2_nclvzdgUtFdEN5jikOUfuOSNYAmbIACSBOAoubR2JxPdc1w"], features: ['Piscina', 'Vista']
        },
        {
            id: 'aluguel_refugio',
            title: 'Refúgio em Meio à Natureza',
            location: 'Enseada de Brito, Palhoça',
            mode: 'rent',
            price_sale: 800000, 
            price_daily: 650, 
            rooms: 2, baths: 1, area: 150,
            description: "Cabana charmosa...",
            available_start: { seconds: new Date(2025, 0, 1).getTime() / 1000 }, 
            available_end: { seconds: new Date(2028, 11, 31).getTime() / 1000 }, 
            images: ["https://lh3.googleusercontent.com/aida-public/AB6AXuCkJXXkq4PB_UELQ6Or3FsXQolSU713nYjOVcOg7O7h9mZAMFnw9MLSucLOIX9Xl1UuJz-opoW2DynbxlFCA6jAjz8MblLDqWpcQikwcGl9sFEGvP5WD2Hw1xyprv5Tz8LdpqvA2En5LrYvk93gob6XOpTFdQPhXMdP3SVezlZhgwwtp7JeOSObNCiEA7z_kaov6rgyNhTfy-D2BZ8WdodHZYO0Z7uv9V5sts2uiNskYExbKQzjz7xvYbUrgUAK4W9lxIfRcII13nk", "https://lh3.googleusercontent.com/aida-public/AB6AXuAUzRiXmLJ42_onfiXrxsiK4CJfeSm4orWZaDZQB7ugJwzvxvDhdjOSS2utvEHnG_iEy0caSRqUJJKl_zAAdSJddrA2W7H8SjkLC99JEYxcq4QF7EFhIq1Pjj-ggjfTKXgwdxL3rLAHKkt0pib5LWca-PGaRkQ5rP9wpN9hzgdvksbDh8KDVrqet_fPipJeVgm4PmJc4gDAJRn0OKuREijyyxjpLT8mfmoNVzEKvcB5plxnO3JWbjdgh62lYaULmC6C2V6g9jz9cms"],
            features: ['Mobiliado', 'Próximo à Trilha', 'Lareira', 'Wi-Fi']
        },
        {
            id: 'venda_loft',
            title: 'Loft Mobiliado', location: 'Praia da Pinheira', mode: 'sale', price_sale: 480000, price_daily: 400, rooms: 1, baths: 1, area: 50,
            description: "Refúgio...", images: ["https://lh3.googleusercontent.com/aida-public/AB6AXuCkJXXkq4PB_UELQ6Or3FsXQolSU713nYjOVcOg7O7h9mZAMFnw9MLSucLOIX9Xl1UuJz-opoW2DynbxlFCA6jAjz8MblLDqWpcQikwcGl9sFEGvP5WD2Hw1xyprv5Tz8LdpqvA2En5LrYvk93gob6XOpTFdQPhXMdP3SVezlZhgwwtp7JeOSObNCiEA7z_kaov6rgyNhTfy-D2BZ8WdodHZYO0Z7uv9V5sts2uiNskYExbKQzjz7xvYbUrgUAK4W9lxIfRcII13nk"], features: ['Mobiliado']
        },
        {
            id: 'venda_terreno',
            title: 'Terreno em Condomínio', location: 'Pinheira', mode: 'sale', price_sale: 800000, price_daily: 0, rooms: 0, baths: 0, area: 800,
            description: "Terreno...", images: ["https://lh3.googleusercontent.com/aida-public/AB6AXuDW5KunHpGD5ge6GVTRYoxzdjDjz1xvRwrcehMbWeJP9g6kkgr2sYQm_QAREW24UZcbDvIQ9mqyh_06CPdjH2Ib4TkCnG2pl5Er687kcgZFq9RvXyFh7e4ianyEhBdRVUAi0jMVsn5t3Uw4mqTRhjJVxOp-LtFR2lmDJLvtyV1LbcGsBKpeuC1MVpm4Bn_l2yZp8e9ToslacCFFgT-5xqoB1yNkkamJJ9fd8s01tVorQ2kSc4b_EW0ti1LPAJ-mhqJCzVDkPvye9Fg"], features: ['Condomínio']
        },
        {
            id: 'aluguel_apto',
            title: 'Apto na Guarda do Embaú (Temporada)',
            location: 'Guarda do Embaú, Palhoça',
            mode: 'rent',
            price_sale: 650000, 
            price_daily: 450, 
            rooms: 2, baths: 2, area: 80,
            description: "Apartamento moderno...",
            available_start: { seconds: new Date(2024, 11, 20).getTime() / 1000 }, 
            available_end: { seconds: new Date(2028, 11, 31).getTime() / 1000 }, 
            images: ["https://lh3.googleusercontent.com/aida-public/AB6AXuBrhKgRWX177WRPwk_g13wOtuyRGA89CkVKEHAMS0nRCh5VYgy6vjjAovXM6hhgKKitQMKei69HWd8_RE9_hFEwzVlPpk8BkStcHlKP9ic2hhZ_RYpn-ljttn8DyMyeuRlGksQMHufgLtUlrziCnygwnNxvWXyE0pA8MF8nAl0YX1jy8g15VsYEMNoVOaQJLLmho8r--H9BGibx_LPH8iGRw671MDfKSJc9bCRGSozavZtNLcMo6kJphfPSfJyXxnn4Oksiedb1UPQ", "https://lh3.googleusercontent.com/aida-public/AB6AXuAQWr66uTJiCxpEEC2kU9O7mC8AFMT39XsOr4c6O5AhVzf6bDTAa5RYR76ksJQ6dRKt6dTVa2nE9HjrecWUDea-PxInZ8eTjGrNoEr84PEyTTIaoLqAnYf-wu8WLlmEUMP9UwlEb1ZiIULHSZavPV2lZQMd4MRtDFCzHZReFEZYVT5fH5UHxMDLxp_4R2XcAnsQGz-VG2G1wqi8oNoUTllBninRP2_nclvzdgUtFdEN5jikOUfuOSNYAmbIACSBOAoubR2JxPdc1w"],
            features: ['2 Quartos', 'Perto da Praia', 'Churrasqueira', 'Mobiliado']
        },
        {
            id: 'aluguel_chale_magico',
            title: 'Chalé Mágico (Pé na Areia)',
            location: 'Praia da Pinheira, Palhoça',
            mode: 'rent',
            price_sale: 950000, 
            price_daily: 1200, 
            rooms: 3, baths: 2, area: 160,
            description: "Chalé exclusivo...",
            available_start: { seconds: new Date(2025, 0, 1).getTime() / 1000 }, 
            available_end: { seconds: new Date(2028, 11, 31).getTime() / 1000 }, 
            images: ["https://lh3.googleusercontent.com/p/AF1QipOezJQNfVpoxOBgEBImQEU3Bqqe2-e5Hf0_pLQ=s680-w680-h510-rw", "https://lh3.googleusercontent.com/p/AF1QipPLi_t6jDG3SKpOnF9sNknT7B3ZVSmVDze6cZU=s680-w680-h510-rw"],
            videoUrl: 'https://www.youtube.com/embed/8sY-J8a1Vp0?autoplay=1&mute=1&loop=1&playlist=8sY-J8a1Vp0&controls=0',
            features: ['Pé na Areia', 'Vista Panorâmica', 'Deck Privativo', 'Lareira'],
            // --- AQUI ESTÃO OS REVIEWS ---
            reviews: [
                {
                    author: "Ana Souza",
                    avatar: "A", 
                    rating: 5,
                    text: "Ambiente pensado nos mínimos detalhes, ótimo lugar para recarregar as energias."
                },
                {
                    author: "Camila Ferreira",
                    avatar: "https://randomuser.me/api/portraits/women/44.jpg",
                    rating: 5,
                    text: "Recepção perfeita, local limpo e com tudo que precisa pra uma estadia maravilhosa..."
                },
                {
                    author: "João Silva",
                    avatar: "https://randomuser.me/api/portraits/men/32.jpg",
                    rating: 5,
                    text: "A visão panorâmica para o mar é como uma obra de arte em constante mudança."
                }
            ]
        }
    ];

    let currentProperty = null;
    let flatpickrInstance = null; 
    const MODAL_WHATSAPP_NUMBER = '5548999998888'; 

    const formatBRL = (number) => number ? number.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }) : 'Consulte';
    const formatTimestamp = (timestamp) => {
        if (timestamp && timestamp.seconds) return new Date(timestamp.seconds * 1000).toLocaleDateString('pt-BR');
        return 'Indefinido';
    };
    const timestampToISODate = (timestamp) => {
        if (timestamp && timestamp.seconds) return new Date(timestamp.seconds * 1000).toISOString().split('T')[0];
        return null;
    };
    const showAlert = (message, title = "Aviso") => {
        const alertModal = document.getElementById('alert-modal');
        if (alertModal) {
            document.getElementById('alert-title').textContent = title; 
            document.getElementById('alert-message').textContent = message; 
            alertModal.classList.add('show'); 
        }
    };

    function changeMainMedia(mediaUrl, isVideo = false) {
        const img = document.getElementById('modal-main-image');
        const iframe = document.getElementById('modal-main-video');
        
        img.classList.add('hidden');
        iframe.classList.add('hidden');
        iframe.src = "";

        if (isVideo) {
            iframe.src = mediaUrl;
            iframe.classList.remove('hidden');
        } else {
            img.src = mediaUrl;
            img.classList.remove('hidden');
        }

        document.querySelectorAll('.gallery-thumbnail').forEach(thumb => {
            thumb.classList.remove('active');
            if (thumb.dataset.mediaUrl === mediaUrl) thumb.classList.add('active');
        });
    }

    function openModal(propertyId) {
        currentProperty = propertyData.find(p => p.id === propertyId);
        const detailsModal = document.getElementById('details-modal');
        if (!currentProperty || !detailsModal) { showAlert('Erro ao abrir.'); return; }

        document.getElementById('modal-title').textContent = currentProperty.title;
        document.getElementById('modal-location').innerHTML = `<span class="material-symbols-outlined text-lg">location_on</span>${currentProperty.location}`;
        document.getElementById('modal-rooms').innerHTML = `<span class="material-symbols-outlined text-primary">bed</span>${currentProperty.rooms}`;
        document.getElementById('modal-baths').innerHTML = `<span class="material-symbols-outlined text-primary">bathtub</span>${currentProperty.baths}`;
        document.getElementById('modal-area').innerHTML = `<span class="material-symbols-outlined text-primary">straighten</span>${currentProperty.area}m²`;
        
        document.getElementById('features-container').innerHTML = currentProperty.features.map(f => 
            `<span class="flex items-center gap-1.5"><span class="material-symbols-outlined text-primary">check_circle</span>${f}</span>`
        ).join('');

        // --- GALERIA DE MÍDIA ---
        const thumbnailsContainer = document.getElementById('modal-thumbnails');
        thumbnailsContainer.innerHTML = '';
        
        const mediaItems = [];
        if (currentProperty.images && Array.isArray(currentProperty.images)) {
            currentProperty.images.forEach(imgUrl => mediaItems.push({ type: 'image', url: imgUrl }));
        }
        if (currentProperty.videoUrl) {
            mediaItems.push({ type: 'video', url: currentProperty.videoUrl });
        }

        mediaItems.forEach((media, index) => {
            const isVideo = media.type === 'video';
            const thumb = document.createElement('img');
            thumb.className = 'gallery-thumbnail rounded-md border-2 border-transparent hover:border-primary';
            thumb.src = isVideo ? 'https://placehold.co/80x80/003366/FFFFFF?text=VIDEO' : media.url;
            thumb.dataset.mediaUrl = media.url;
            thumb.onclick = () => changeMainMedia(media.url, isVideo);
            thumbnailsContainer.appendChild(thumb);
        });

        if (mediaItems.length > 0) {
            changeMainMedia(mediaItems[0].url, mediaItems[0].type === 'video');
        } else {
             changeMainMedia('https://placehold.co/800x600?text=Sem+Imagem', false);
        }

        // --- LÓGICA DE REVIEWS (INSERIDA) ---
        const reviewsContainer = document.getElementById('reviews-container');
        const reviewsList = document.getElementById('reviews-list');
        reviewsList.innerHTML = '';

        if (currentProperty.reviews && currentProperty.reviews.length > 0) {
            reviewsContainer.classList.remove('hidden');
            
            currentProperty.reviews.forEach(review => {
                let starsHtml = '';
                for(let i=0; i<5; i++) {
                    starsHtml += `<span class="material-symbols-outlined text-sm ${i < review.rating ? 'text-yellow-400 fill-current' : 'text-gray-300'}">star</span>`;
                }

                let avatarHtml = '';
                if (review.avatar.length > 2) {
                    avatarHtml = `<img src="${review.avatar}" class="w-10 h-10 rounded-full object-cover">`;
                } else {
                    avatarHtml = `<div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center font-bold">${review.avatar}</div>`;
                }

                const reviewItem = document.createElement('div');
                reviewItem.className = "bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700";
                reviewItem.innerHTML = `
                    <div class="flex items-start gap-3">
                        ${avatarHtml}
                        <div>
                            <p class="text-sm font-bold text-gray-900 dark:text-white">${review.author}</p>
                            <div class="flex items-center -ml-1 mb-1">${starsHtml}</div>
                            <p class="text-sm text-gray-600 dark:text-gray-300 italic">"${review.text}"</p>
                        </div>
                    </div>
                `;
                reviewsList.appendChild(reviewItem);
            });
        } else {
            reviewsContainer.classList.add('hidden');
        }

        // --- MODO ALUGUEL ---
        const priceLabelEl = document.getElementById('modal-price-label');
        const priceValueEl = document.getElementById('modal-price');
        const datesInfoEl = document.getElementById('dates-info');
        
        priceLabelEl.textContent = 'Preço por Diária';
        priceValueEl.textContent = formatBRL(currentProperty.price_daily);
        datesInfoEl.innerHTML = `Disponível de ${formatTimestamp(currentProperty.available_start)} até ${formatTimestamp(currentProperty.available_end)}`;
        datesInfoEl.classList.remove('hidden');

        document.getElementById('modal-sale-form').classList.add('hidden');
        document.getElementById('modal-rent-form').classList.remove('hidden');
        
        document.getElementById('rent-date-range').value = "";
        document.getElementById('reservation-summary').classList.add('hidden');
        if (flatpickrInstance) { flatpickrInstance.destroy(); }
        flatpickrInstance = flatpickr("#rent-date-range", { mode: "range", minDate: "today", dateFormat: "d/m/Y", locale: "pt" });

        detailsModal.classList.add('show');
    }

    function generatePropertyCards() {
        const grid = document.getElementById('properties-grid');
        if (!grid) return;

        const rentProperties = propertyData.filter(prop => prop.mode === 'rent');

        if (rentProperties.length === 0) {
            grid.innerHTML = '<p class="col-span-3 text-center text-gray-500">Nenhum imóvel para aluguel encontrado.</p>';
            return;
        }

        grid.innerHTML = rentProperties.map(prop => `
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 group cursor-pointer" onclick="openModal('${prop.id}')">
                <div class="relative">
                    <img class="h-64 w-full object-cover" data-alt="${prop.title}" src="${prop.images[0] || 'https://placehold.co/800x600/e2e8f0/e2e8f0?text=Imóvel'}"/>
                    <div class="absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-black/60 to-transparent"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="font-display font-bold text-lg drop-shadow-md">${formatBRL(prop.price_daily)} / diária</p>
                        <p class="text-xs">Aluguel</p>
                    </div>
                </div>
                <div class="p-5">
                    <h3 class="font-display font-bold text-lg text-gray-900 dark:text-white group-hover:text-primary transition-colors">${prop.title}</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-3">${prop.location}</p>
                    <button class="w-full mt-4 py-2.5 px-4 bg-primary dark:bg-primary text-white text-sm font-bold rounded-lg hover:bg-primary/90 transition-colors">Ver Detalhes</button>
                </div>
            </div>
        `).join('');
    }

    function setupRentFormListener() {
        const rentForm = document.getElementById('modal-rent-form');
        if (!rentForm) return;

        rentForm.addEventListener('submit', async (e) => { 
            e.preventDefault();
            
            const dates = document.getElementById('rent-date-range').value.trim();
            const contact = document.getElementById('rent-guest-contact').value.trim();
            const name = document.getElementById('rent-guest-name').value.trim();
            const adults = parseInt(document.getElementById('guests-adults').value) || 0;
            const children = parseInt(document.getElementById('guests-children').value) || 0;
            
            if (!dates || !contact || !name) { 
                showAlert('Por favor, preencha todos os campos obrigatórios.'); 
                return; 
            }
            
            let parts = dates.split(' até ');
            if (parts.length !== 2) {
                parts = dates.split(' a ');
            }

            if (parts.length !== 2) { 
                showAlert('Por favor, selecione as datas de entrada e saída no calendário.'); 
                return; 
            }
            
            const dateInStr = parts[0].trim();
            const dateOutStr = parts[1].trim();

            const [dayIn, monthIn, yearIn] = dateInStr.split('/').map(Number);
            const [dayOut, monthOut, yearOut] = dateOutStr.split('/').map(Number);
            const dateInObj = new Date(yearIn, monthIn - 1, dayIn);
            const dateOutObj = new Date(yearOut, monthOut - 1, dayOut);
            
            const diffTime = Math.abs(dateOutObj - dateInObj);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            const nights = diffDays > 0 ? diffDays : 1;
            
            const totalEstimated = currentProperty.price_daily * nights;

            const whatsappMessage = encodeURIComponent(
                `*Nova Solicitação de Reserva*\n` +
                `Nome: ${name}\n` +
                `Imóvel: ${currentProperty.title}\n` +
                `Datas: ${dateInStr} até ${dateOutStr} (${nights} diárias)\n` +
                `Hóspedes: ${adults} ad., ${children} cri.\n` +
                `Valor Estimado: ${formatBRL(totalEstimated)}\n`
            );
            
            const whatsappUrl = `https://api.whatsapp.com/send?phone=${MODAL_WHATSAPP_NUMBER}&text=${whatsappMessage}`;
            
            window.open(whatsappUrl, '_blank');
            // window.open(MERCADOPAGO_CHECKOUT_URL, '_blank'); // Opcional
            
            showAlert('Solicitação enviada para o WhatsApp!');
        });
    }

    function initializePage() {
        const closeBtn = document.getElementById('close-modal-button');
        if (closeBtn) closeBtn.addEventListener('click', () => { 
            document.getElementById('details-modal').classList.remove('show'); 
            const iframe = document.getElementById('modal-main-video');
            if(iframe) iframe.src = "";
            if (flatpickrInstance) flatpickrInstance.destroy(); 
        });
        
        const alertOkBtn = document.getElementById('alert-ok-button');
        if (alertOkBtn) alertOkBtn.addEventListener('click', () => document.getElementById('alert-modal').classList.remove('show'));

        setupRentFormListener();
        generatePropertyCards();
    }
    document.addEventListener('DOMContentLoaded', initializePage);
</script>

<footer class="bg-gray-900 dark:bg-black text-gray-300">
    <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center">
        <p>© 2024 Curtindo SC. Todos os direitos reservados.</p>
    </div>
</footer>
</div>
</div>
</body></html>
